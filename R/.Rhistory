################################################################################
# rcp85 2071-2100
################################################################################
#lapply(1:5, function(x)dataInventory(datasets.85_cmip5[x]))
str(UDG.datasets())
(sets <- UDG.datasets())
names(sets)
sets$OBSERVATIONS
sets$CMIP5_subset
UDG.datasets()
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_subset
Availablecmip5
grep("rcp85",Availablecmip5)
Availablecmip5[grep("rcp85",Availablecmip5)]
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_AR5
grep("rcp85",Availablecmip5)
Availablecmip5[grep("rcp85",Availablecmip5)]
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_subset
grep("rcp85",Availablecmip5)
Availablecmip5[grep("rcp85",Availablecmip5)]
cmip5.sub85 <- Availablecmip5[grep("rcp85",Availablecmip5)]
URLs.cmip5.sub85 <- UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset
URLs.cmip5.sub85
str(URLs.cmip5.sub85)
str(Availablecmip5)
URLs.cmip5.sub85 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)["url"]
URLs.cmip5.sub85
URLs.cmip5.sub85 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)[,3]
URLs.cmip5.sub85
URLs.cmip5.sub85 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)[,"url"]
URLs.cmip5.sub85
str(URLs.cmip5.sub85)
cmip5.sub85
URLs.cmip5.sub85 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)[,"url"]
URLs.cmip5.sub85
URLs.cmip5
URLs.cmip5
URLs.cmip5 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)[,"url"]
URLs.cmip5
cmip5.sub85 <- grep("rcp85",Availablecmip5)
URLs.cmip5.sub85 <- URLs.cmip5[cmip5.sub85]
URLs.cmip5.sub85
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_subset
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_AR5_1run
URLs.cmip5 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_subset)[,"url"]
cmip5.sub85 <- grep("rcp85",Availablecmip5)
URLs.cmip5.sub85 <- URLs.cmip5[cmip5.sub85]
URLs.cmip5.sub85
Availablecmip5
URLs.cmip5 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_AR5_1run)[,"url"]
cmip5.sub85 <- grep("rcp85",Availablecmip5)
URLs.cmip5.sub85 <- URLs.cmip5[cmip5.sub85]
URLs.cmip5.sub85
Availablecmip5  <- UDG.datasets("CMIP5")$CMIP5_AR5
URLs.cmip5 <- (UDG.datasets("CMIP5",full.info = TRUE)$CMIP5_AR5)[,"url"]
cmip5.sub85 <- grep("rcp85",Availablecmip5)
URLs.cmip5.sub85 <- URLs.cmip5[cmip5.sub85]
URLs.cmip5.sub85
subr1 <- grep("r1i1",cmip5inv$X)
subr2 <- grep("r2i1",cmip5inv$X)
subhist <- grep("historical",cmip5inv$X)
subr1 <- grep("r1i1",Availablecmip5)
subr2 <- grep("r2i1",Availablecmip5)
subr1
cmip5inv$X
cmip5inv$X
subr1 <- grep("r1i1",Availablecmip5)
subr2 <- grep("r2i1",Availablecmip5)
subhist <- grep("historical",Availablecmip5)
submodels <- grep("Had|CNRM|Can|EARTH|GFDL|IPSL|MIROC|MPI|Nor",Availablecmip5)
sub85 <- grep("rcp85",Availablecmip5)
UDG.datasets("CMIP5.*rcp85")$CMIP5_subset
# datasets with requistitos
select85 <- intersect(intersect(subtas,subr1),intersect(sub85,submodels))
UDG.datasets
UDG.datasets()
UDG.datasets(,full.info = TRUE)
str(UDG.datasets(,full.info = TRUE))
# datasets with requistitos
select85 <- intersect(subr1,intersect(sub85,submodels))
Availablecmip5[select85]
URLs.cmip5.sub85 <- URLs.cmip5[select85]
URLs.cmip5.sub85
# Manually add r12i1p1 and r2i1p1 for earth
subr2 <- grep("r2i1",Availablecmip5)
subr12 <- grep("r12i1",Availablecmip5)
subearth <- grep("EARTH",Availablecmip5)
earthr2rcp85 <- intersect(sub85,intersect(subr2,subearth))
earthr12rcp85 <- intersect(sub85,intersect(subr12,subearth))
select85plus <- c(select85,earthr2rcp85,earthr12rcp85)
URLs.cmip5.sub85 <- URLs.cmip5[select85plus]
URLs.cmip5.sub85
str(URLs.cmip5.sub85)
datasets.85_cmip5 <- Availablecmip5[select85plus]
datasets.85_cmip5
gsub(datasets.85_cmip5, pattern = "-", replacement = ".")
# download.file("https://raw.githubusercontent.com/SantanderMetGroup/ATLAS/master/ATLAS-inventory/Hub/CMIP6_mon_Hub.csv",
# destfile = "/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv", method = "curl")
cmip6inv2 <- read.csv("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv")
download.file("https://raw.githubusercontent.com/SantanderMetGroup/ATLAS/master/ATLAS-inventory/Hub/CMIP6_mon_Hub.csv",
destfile = "/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv", method = "curl")
cmip6inv2 <- read.csv("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv")
# requisitos
c6subtas <- which(cmip6inv2$tas == TRUE,arr.ind = TRUE)
#download.file("https://raw.githubusercontent.com/SantanderMetGroup/ATLAS/master/ATLAS-inventory/Hub/CMIP6_mon_Hub.csv",
#             destfile = "/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv", method = "curl")
cmip6inv2 <- read.csv("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv")
# requisitos
c6subtas <- which(cmip6inv2$tas == TRUE,arr.ind = TRUE)
cmip6[1,]
cmip6inv2[1,]
cmip6inv2tas <-cmip6inv2[c6subtas,]
#c6subr1 <- grep("r1i1",cmip6inv2$X)
c6subhist <- grep("historical",cmip6inv2tas$X)
#c6subr1 <- grep("r1i1",cmip6inv2$X)
c6subhisttas <- grep("historical",cmip6inv2tas$X)
c6subhisttas
cmip6inv2tashist <- cmip6inv2tas[c6subhisttas,]
cmip6inv2tashist
cmip6inv2tashist$X
gsub(cmip6inv2tashist$X, pattern = "historical", replacement = "ssp585")
cmip6inv2potssp585 <- gsub(cmip6inv2tashist$X, pattern = "historical", replacement = "ssp585")
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2potssp585%in%cmip6inv2tas$X
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2_ssp585inhist <- cmip6inv2potssp585%in%cmip6inv2tas$X
cmip6inv2tasssp585 <- cmip6inv2tas[cmip6inv2_ssp585inhist,]
cmip6inv2tasssp585
cmip6inv2tas[cmip6inv2_ssp585inhist,]
gsub(cmip6inv2tashist$X, pattern = "historical", replacement = "ssp585")
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2_ssp585inhist <- cmip6inv2potssp585%in%cmip6inv2tas$X
cmip6inv2tas[cmip6inv2_ssp585inhist,]
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2_ssp585inhist <- cmip6inv2potssp585%in%(cmip6inv2tas$X)
cmip6inv2tas[cmip6inv2_ssp585inhist,]
cmip6inv2potssp585
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2[cmip6inv2potssp585,]
cmip6inv2potssp585
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2$X[cmip6inv2potssp585,]
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2$X[cmip6inv2potssp585]
cmip6inv2potssp585
#c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv2$X)
cmip6inv2$X[cmip6inv2potssp585]
cmip6inv2potssp585
cmip6inv2tas$X
as.vector(cmip6inv2tas$X)
cmip6inv2potssp585%in%as.vector(cmip6inv2tas$X)
cmip6inv2_ssp585inhist <- cmip6inv2potssp585%in%as.vector(cmip6inv2tas$X)
cmip6inv2tas[cmip6inv2_ssp585inhist,]
cmip6inv2potssp585%in%as.vector(cmip6inv2tas$X)
cmip6inv2_ssp585inhist <- cmip6inv2potssp585%in%as.vector(cmip6inv2tas$X)
cmip6inv2tasssp585 <- cmip6inv2tas$X[cmip6inv2_ssp585inhist]
cmip6inv2tasssp585
which(cmip6inv2potssp585 == as.vector(cmip6inv2tas$X))
as.vector(cmip6inv2tas$X)
cmip6inv2potssp585
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, funciton(x)which(x == as.vector(cmip6inv2tas$X))
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)which(x == as.vector(cmip6inv2tas$X))
)
cmip6inv2_ssp585inhist
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)which(x == as.vector(cmip6inv2tas$X)),simplify = TRUE)
cmip6inv2_ssp585inhist
c(cmip6inv2_ssp585inhist)
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)grep(^x$,cmip6inv2tas$X))
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)grep(paste0("^",x,"$",cmip6inv2tas$X)))
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)grep(paste0("^",x,"$"),cmip6inv2tas$X))
cmip6inv2_ssp585inhist
unlist(cmip6inv2_ssp585inhist)
cmip6inv2ssp585 <- cmipt6inv2tas[cmip6inv2_ssp585inhist,]
cmip6inv2ssp585 <- cmip6inv2tas[cmip6inv2_ssp585inhist,]
cmip6inv2ssp585 <- cmip6inv2tas[unlist(cmip6inv2_ssp585inhist),]
cmip6inv2ssp585
cmip6inv2ssp585
cmip6inv2tasssp585
cmip6inv2_ssp585inhist
cmip6inv2ssp585
gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")
cmip6inv2hist <- cmip6inv2tas[gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical"),]
cmip6inv2hist
gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")
cmip6inv2hist <- cmip6inv2tas$X[gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")]
cmip6inv2hist
cmip6inv2hist <- cmip6inv2tas[gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical"),]
cmip6inv2hist
cmip6inv2potssp585
cmip6inv2ssp585
cmip6inv2ssp585$X
cmip6inv2_ssp585inhist
unlist(cmip6inv2_ssp585inhist)
cmip6inv2ssp585
gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")
cmip6inv2targethist <- gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")
cmip6inv2_histeqssp585 <-sapply(cmip6inv2targethist, function(x)grep(paste0("^",x,"$"),cmip6inv2tas$X))
cmip6inv2_histeqssp585
cmip6inv2hist <- cmip6inv2tas[cmip6inv2_histeqssp585,]
cmip6inv2hist
load("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/tas_historical_cmip6_10d_akima_cubic_corrected.rda")
names(tas_historical_cmip6_10d_akima_cubic_corrected)
cmip6inv2hist
gsub("historical.*",names(tas_historical_cmip6_10d_akima_cubic_corrected))
names(tas_historical_cmip6_10d_akima_cubic_corrected)
gsub(names(tas_historical_cmip6_10d_akima_cubic_corrected), "historical.*")
gsub(X = names(tas_historical_cmip6_10d_akima_cubic_corrected), pattern = "historical.*", replacement = "")
gsub(pattern = "historical.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
gsub(pattern = "historical*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
gsub(pattern = "historical.", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
gsub(pattern = "historical.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
gsub(pattern = "historical*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
names(tas_historical_cmip6_10d_akima_cubic_corrected)
gsub(pattern = "r1.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
gsub(pattern = "_r1.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
oldhist <- gsub(pattern = "_r1.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
cmip6inv2hist
cmip6inv2hist$X
sapply(oldhist,function(x)grep(x,as.vector(cmip6inv2hist$X)))
oldhist
sapply(oldhist,function(x)grep(x,as.vector(cmip6inv2hist$X)))
oldhist
cmip6inv2hist$X
gsub("-",".",as.vector(cmip6inv2hist$X))
sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X))))
oldhist
as.vector(cmip6inv2hist$X)
sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X))))
unlist(sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X)))))
lefthist <- unlist(sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X)))))
oldinhist <- unlist(sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X)))))
cmipt6inv2hist[!oldinhist,]
cmip6inv2hist[!oldinhist,]
!oldinhist
oldinhist
1:length(as.vector(cmip6inv2hist$X))
cmip6inv2hist[-oldinhist,]
cmip6inv2hist[-oldinhist,]
cmip6inv2hist[-oldinhist,]$X
as,vector(cmip6inv2hist[-oldinhist,]$X)
as.vector(cmip6inv2hist[-oldinhist,]$X)
grep("r1",as.vector(cmip6inv2hist[-oldinhist,]$X))
lefthistr1 <- grep("r1",as.vector(cmip6inv2hist[-oldinhist,]$X))
cmip6inv2hist[,lefthistr1]
cmip6inv2hist[lefthistr1,]
cmip6inv2hist[-oldinhist,]$X[lefthistr1]
as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
datasets.85_cmip6
# download.file("https://raw.githubusercontent.com/SantanderMetGroup/ATLAS/master/AtlasHub-inventory/Hub/CMIP6Amon_Hub_20191028.csv",
# destfile = "/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6Amon_Hub_20191028.csv", method = "curl")
cmip6inv <- read.csv("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6Amon_Hub_20191028.csv")
# requisitos
c6subtas <- which(cmip6inv$tas == TRUE,arr.ind = TRUE)
c6subr1 <- grep("r1i1",cmip6inv$X)
c6subr1 <- grep("r1",cmip6inv$X)
c6subr2 <- grep("r2i1",cmip6inv$X)
c6subhist <- grep("historical",cmip6inv$X)
c6submodels <- grep("Had|CNRM|Can|Earth|GFDL|IPSL|MIROC|MPI|Nor",cmip6inv$X)
c6sub85 <- grep("85",cmip6inv$X)
# datasets with requistitos
c6select85 <- intersect(intersect(c6subtas,c6subr1),intersect(c6sub85,c6submodels))
c6select85 <- intersect(c6subtas,intersect(c6sub85,c6submodels))
datasets.85_cmip6 <- cmip6inv$X[c6select85]
datasets.85_cmip6
c6selecthist <- intersect(intersect(c6subtas,c6subr1),intersect(c6subhist,c6submodels)) # CHECK IF REALMENTE R1 has all
datasets_cmip6 <- cmip6inv$X[c6selecthist]
datasets_cmip6
datasets_cmip6_left <- cmip6as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
datasets_cmip6_left <- as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
datasets_cmip6_historical_left <- as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
load("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/tas_ssp585_cmip6_10d_akima_cubic_corrected.rda")
names(tas_ssp585_cmip6_10d_akima_cubic_corrected)
oldssp585 <- gsub(pattern = "_ssp585*", replacement = "",x = names(tas_ssp585_cmip6_10d_akima_cubic_corrected))
oldssp585
oldssp585 <- gsub(pattern = "_ssp585.*", replacement = "",x = names(tas_ssp585_cmip6_10d_akima_cubic_corrected))
oldssp585
oldinssp585 <- unlist(sapply(oldssp585,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2ssp585$X)))))
oldinssp585
leftssp585r1 <- grep("r1",as.vector(cmip6inv2ssp585[-oldinssp585,]$X))
leftssp585r1
datasets_cmip6_ssp585_left <- as.vector(cmip6inv2ssp585[-oldinssp585,]$X[leftssp585r1])
datasets_cmip6_ssp585_left
cmip6inv2ssp585[-oldinssp585,]$X
datasets_cmip6_ssp585_left
UDG.datasets("CMIP6")
library(devtools)
library(loadeR)
library(transformeR)
library(visualizeR)
source("/oceano/gmeteo/WORK/lisette/Trabajo/creds")
UDG.datasets("CMIP6")
UDG.datasets("CMIP6")$CMIP6Amon
Availablecmip6
UDG.datasets("CMIP6")$CMIP6Amon
URLs.cmip6 <- (UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
URLs.cmip6
UDG.datasets("CMIP6",full.info = TRUE)
UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon
(UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
URLs.cmip6 <- (UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
URLs.cmip6
wanted_hleft <- datasets_cmip6_historical_left
todownload_hleft <- is.element(as.character(wanted_hleft),Availablecmip6)
#########################################################################
# Check which CMIP6 left models that could be still implemented
#########################################################################
Availablecmip6  <- UDG.datasets("CMIP6")$CMIP6Amon
todownload_hleft <- is.element(as.character(wanted_hleft),Availablecmip6)
todownload_hleft
datasets_cmip6_historical_left
cmip6_ssp585_left <- as.vector(cmip6inv2ssp585[-oldinssp585,]$X[leftssp585r1])
wanted_hleft <- cmip6_historical_left
cmip6_historical_left <- as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
wanted_hleft <- cmip6_historical_left
todownload_hleft <- is.element(as.character(wanted_hleft),Availablecmip6)
datasets.hist_cmip6_left <- wanted_hleft[todownload]
datasets.hist_cmip6_left <- wanted_hleft[todownload_hleft]
datasets.hist_cmip6_left
Availablecmip6 <- UDG.datasets("CMIP6")$CMIP6Amon
URLs.cmip6 <- (UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
wanted_hleft <- cmip6_historical_left
todownload_hleft <- is.element(as.character(wanted_hleft),Availablecmip6)
datasets.hist_cmip6_left <- wanted_hleft[todownload_hleft]
cmip6_historical_left
sapply(cmip6_historical_left,function(x)which(x==Availablecmip6))
todownload_hleft <- sapply(cmip6_historical_left,function(x)which(x==Availablecmip6))
todownload_hleft
URLs.cmip6.hist.left <- URLs.cmip6[todownload_hleft]
URLs.cmip6.hist.left
todownload_cmip6.hist.left <- sapply(cmip6_historical_left,function(x)which(x==Availablecmip6))
URLs.cmip6.hist.left <- URLs.cmip6[todownload_cmip6.hist.left]
datasets.hist_cmip6_left <- wanted_hleft[URLs.cmip6.hist.left ]
datasets.hist_cmip6_left
URLs.cmip6.hist.left
todownload_cmip6.hist.left
cmip6_historical_left
cmip6_historical_left
URLs.cmip6.hist.left <- URLs.cmip6[todownload_cmip6.hist.left]
datasets.hist_cmip6_left <- wanted_hleft[URLs.cmip6.hist.left]
gsub(datasets.hist_cmip6_left, pattern = "-", replacement = ".")
datasets.hist_cmip6_left
datasets.hist_cmip6_left <- cmip6_historical_left
datasets.hist_cmip6_left
gsub(datasets.hist_cmip6_left, pattern = "-", replacement = ".")
rm(list = ls())
library(devtools)
library(loadeR)
library(transformeR)
library(visualizeR)
source("/oceano/gmeteo/WORK/lisette/Trabajo/creds")
#########################################################################
# Check which CMIP6 left models that could be still implemented
#########################################################################
Availablecmip6  <- UDG.datasets("CMIP6")$CMIP6Amon
#download.file("https://raw.githubusercontent.com/SantanderMetGroup/ATLAS/master/ATLAS-inventory/Hub/CMIP6_mon_Hub.csv",
#             destfile = "/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv", method = "curl")
cmip6inv2 <- read.csv("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/CMIP6_mon_Hub.csv")
# requisitos
c6subtas <- which(cmip6inv2$tas == TRUE,arr.ind = TRUE)
cmip6inv2tas <-cmip6inv2[c6subtas,]
#c6subr1 <- grep("r1i1",cmip6inv2$X)
c6subhisttas <- grep("historical",cmip6inv2tas$X)
cmip6inv2tashist <- cmip6inv2tas[c6subhisttas,]
cmip6inv2potssp585 <- gsub(cmip6inv2tashist$X, pattern = "historical", replacement = "ssp585")
cmip6inv2_ssp585inhist <- sapply(cmip6inv2potssp585, function(x)grep(paste0("^",x,"$"),cmip6inv2tas$X))
cmip6inv2ssp585 <- cmip6inv2tas[unlist(cmip6inv2_ssp585inhist),]
cmip6inv2targethist <- gsub(cmip6inv2ssp585$X, pattern = "ssp585", replacement = "historical")
cmip6inv2_histeqssp585 <-sapply(cmip6inv2targethist, function(x)grep(paste0("^",x,"$"),cmip6inv2tas$X))
cmip6inv2hist <- cmip6inv2tas[cmip6inv2_histeqssp585,]
load("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/tas_historical_cmip6_10d_akima_cubic_corrected.rda")
oldhist <- gsub(pattern = "_r1.*", replacement = "",x = names(tas_historical_cmip6_10d_akima_cubic_corrected))
oldinhist <- unlist(sapply(oldhist,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2hist$X)))))
lefthistr1 <- grep("r1",as.vector(cmip6inv2hist[-oldinhist,]$X))
cmip6_historical_left <- as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
cmip6_historical_left
load("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/tas_ssp585_cmip6_10d_akima_cubic_corrected.rda")
oldssp585 <- gsub(pattern = "_ssp585.*", replacement = "",x = names(tas_ssp585_cmip6_10d_akima_cubic_corrected))
oldinssp585 <- unlist(sapply(oldssp585,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2ssp585$X)))))
leftssp585r1 <- grep("r1",as.vector(cmip6inv2ssp585[-oldinssp585,]$X))
cmip6_ssp585_left <- as.vector(cmip6inv2ssp585[-oldinssp585,]$X[leftssp585r1])
cmip6_ssp585_left
#########################################################################
#  historical CMIP6 left
#########################################################################
Availablecmip6 <- UDG.datasets("CMIP6")$CMIP6Amon
URLs.cmip6 <- (UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
todownload_cmip6.hist.left <- sapply(cmip6_historical_left,function(x)which(x==Availablecmip6))
datasets.hist_cmip6_left <- cmip6_historical_left
URLs.cmip6.hist.left <- URLs.cmip6[todownload_cmip6.hist.left]
URLs.cmip6.hist.left
gsub(datasets.hist_cmip6_left, pattern = "-", replacement = ".")
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
cmip6_left_historicalinv <- lapply(datasets.hist_cmip6_left, function(x) dataInventory(x))
timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
timeranges_hist_cmip6_left
names(cmip6_left_historicalinv) <- datasets.hist_cmip6_left
timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
timeranges_hist_cmip6_left
cmip6_historical_left_provisional <- as.vector(cmip6inv2hist[-oldinhist,]$X[lefthistr1])
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
# cmip6_left_historicalinv <- lapply(cmip6_historical_left_provisional, function(x) dataInventory(x))
# names(cmip6_left_historicalinv) <- cmip6_historical_left_provisional
# timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
# timeranges_hist_cmip6_left
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS! Eruit halen.
cmip6_historical_left_provisional[-c("CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1")]
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
# cmip6_left_historicalinv <- lapply(cmip6_historical_left_provisional, function(x) dataInventory(x))
# names(cmip6_left_historicalinv) <- cmip6_historical_left_provisional
# timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
# timeranges_hist_cmip6_left
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS! Eruit halen.
cmip6_historical_left_provisional[-"CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1"]
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
# cmip6_left_historicalinv <- lapply(cmip6_historical_left_provisional, function(x) dataInventory(x))
# names(cmip6_left_historicalinv) <- cmip6_historical_left_provisional
# timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
# timeranges_hist_cmip6_left
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS! Eruit halen.
which(cmip6_historical_left_provisional=="CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1")
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
# cmip6_left_historicalinv <- lapply(cmip6_historical_left_provisional, function(x) dataInventory(x))
# names(cmip6_left_historicalinv) <- cmip6_historical_left_provisional
# timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
# timeranges_hist_cmip6_left
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS! Eruit halen.
cmip6_historical_left_provisional[-which(cmip6_historical_left_provisional=="CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1")]
#########################################################################
#  historical CMIP6 left
#########################################################################
# Check dates historical CMIP6 left models:
# cmip6_left_historicalinv <- lapply(cmip6_historical_left_provisional, function(x) dataInventory(x))
# names(cmip6_left_historicalinv) <- cmip6_historical_left_provisional
# timeranges_hist_cmip6_left <- sapply(cmip6_left_historicalinv, function(x) x$tas$Dimensions$time$Date_range)
# timeranges_hist_cmip6_left
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS! Eruit halen.
cmip6_historical_left<- cmip6_historical_left_provisional[-which(cmip6_historical_left_provisional=="CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1")]
Availablecmip6 <- UDG.datasets("CMIP6")$CMIP6Amon
URLs.cmip6 <- (UDG.datasets("CMIP6",full.info = TRUE)$CMIP6Amon)[,"url"]
todownload_cmip6.hist.left <- sapply(cmip6_historical_left,function(x)which(x==Availablecmip6))
datasets.hist_cmip6_left <- cmip6_historical_left
URLs.cmip6.hist.left <- URLs.cmip6[todownload_cmip6.hist.left]
URLs.cmip6.hist.left
load("/oceano/gmeteo/WORK/lisette/Trabajo/R_practice/exp_GCMs/data/tas_ssp585_cmip6_10d_akima_cubic_corrected.rda")
oldssp585 <- gsub(pattern = "_ssp585.*", replacement = "",x = names(tas_ssp585_cmip6_10d_akima_cubic_corrected))
oldinssp585 <- unlist(sapply(oldssp585,function(x)grep(x,gsub("-",".",as.vector(cmip6inv2ssp585$X)))))
leftssp585r1 <- grep("r1",as.vector(cmip6inv2ssp585[-oldinssp585,]$X))
cmip6_ssp585_left_provisional <- as.vector(cmip6inv2ssp585[-oldinssp585,]$X[leftssp585r1])
#########################################################################
#  ssp585 CMIP6 left
#########################################################################
# Check dates ssp585 CMIP6 left models:
cmip6_left_ssp585inv <- lapply(cmip6_historical_ssp585_provisional, function(x) dataInventory(x))
#########################################################################
#  ssp585 CMIP6 left
#########################################################################
# Check dates ssp585 CMIP6 left models:
cmip6_left_ssp585inv <- lapply(cmip6_ssp585_left_provisional, function(x) dataInventory(x))
names(cmip6_left_ssp585inv) <- cmip6_ssp585_left_provisional
cmip6_ssp585_left_provisional
cmip6_ssp585_left_provisional[-10]
# CMIP6Amon_GFDL-CM4_ssp585_r1i1p1f1 (No such file or directory)
cmip6_left_ssp585inv <- lapply(cmip6_ssp585_left_provisional[-(1:10)], function(x) dataInventory(x))
#########################################################################
#  ssp585 CMIP6 left
#########################################################################
# Check dates ssp585 CMIP6 left models:
cmip6_left_ssp585inv <- lapply(cmip6_ssp585_left_provisional[-10], function(x) dataInventory(x))
names(cmip6_left_ssp585inv) <- cmip6_ssp585_left_provisional[-10]
timeranges_ssp585_cmip6_left <- sapply(cmip6_left_ssp585inv, function(x) x$tas$Dimensions$time$Date_range)
timeranges_ssp585_cmip6_left
# CMIP6Amon_GFDL-CM4_ssp585_r1i1p1f1 (No such file or directory) (=10)
# CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1 Heeft geen TAS in historical eruit halen. (=1)
# CMIP6Amon_CAMS-CSM1-0_ssp585_r1i1p1f1 tot 2099, eruit halen.
x1 <-which(cmip6_ssp585_left_provisional=="CMIP6Amon_GFDL-CM4_ssp585_r1i1p1f1")
x2 <-which(cmip6_ssp585_left_provisional=="CMIP6Amon_AWI-CM-1-1-MR_historical_r1i1p1f1")
x3 <-which(cmip6_ssp585_left_provisional=="CMIP6Amon_CAMS-CSM1-0_ssp585_r1i1p1f1")
cmip6_ssp585_left<- cmip6_ssp585_left_provisional[-c(x1,x2,x3)]
cmip6_ssp585_left
x1
x2
x2 <-which(cmip6_ssp585_left_provisional=="CMIP6Amon_AWI-CM-1-1-MR_ssp585_r1i1p1f1")
x3 <-which(cmip6_ssp585_left_provisional=="CMIP6Amon_CAMS-CSM1-0_ssp585_r1i1p1f1")
cmip6_ssp585_left<- cmip6_ssp585_left_provisional[-c(x1,x2,x3)]
cmip6_ssp585_left
todownload_cmip6.ssp585.left <- sapply(cmip6_ssp585_left,function(x)which(x==Availablecmip6))
todownload_cmip6.ssp585.left
Availablecmip6
todownload_cmip6.ssp585.left
Availablecmip6[c(89, 798)]
datasets.ssp585_cmip6_left <- cmip6_ssp585_left
Availablecmip6
todownload_cmip6.ssp585.left <- sapply(cmip6_ssp585_left,function(x)which(x==Availablecmip6)[1])
todownload_cmip6.ssp585.left
# CMIP6Amon_FGOALS-g3_ssp585_r1i1p1f1 heeft twee matches!!! Availablecmip6[c(89, 798)]
datasets.ssp585_cmip6_left <- cmip6_ssp585_left
URLs.cmip6.ssp585.left <- URLs.cmip6[todownload_cmip6.ssp585.left]
